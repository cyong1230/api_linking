Remove	O
rows	O
with	O
duplicate	O
indices	O
(	O
Pandas	O
DataFrame	B-API
and	O
TimeSeries	O
)	O

I'm	O
reading	O
some	O
automated	O
weather	O
data	O
from	O
the	O
web	O
.	O

The	O
observations	O
occur	O
every	O
5	O
minutes	O
and	O
are	O
compiled	O
into	O
monthly	O
files	O
for	O
each	O
weather	O
station	O
.	O

Once	O
I'm	O
done	O
parsing	O
a	O
file	O
,	O
the	O
DataFrame	B-API
looks	O
something	O
like	O
this	O
:	O

@CODE	O

The	O
problem	O
I'm	O
having	O
is	O
that	O
sometimes	O
a	O
scientist	O
goes	O
back	O
and	O
corrects	O
observations	O
--	O
not	O
by	O
editing	O
the	O
erroneous	O
rows	O
,	O
but	O
by	O
appending	O
a	O
duplicate	O
row	O
to	O
the	O
end	O
of	O
a	O
file	O
.	O

Simple	O
example	O
of	O
such	O
a	O
case	O
is	O
illustrated	O
below	O
:	O

@CODE	O

And	O
so	O
I	O
need	O
`	O
df3	O
`	O
to	O
evenutally	O
become	O
:	O

@CODE	O

I	O
thought	O
that	O
adding	O
a	O
column	O
of	O
row	O
numbers	O
(`df3['rownum	O
'	O
]	O
=	O
range	O
(	O
df3.shape	O
[0]	O
)`)	O
would	O
help	O
me	O
select	O
out	O
the	O
bottom-most	O
row	O
for	O
any	O
value	O
of	O
the	O
`	O
DatetimeIndex	B-API
`	O
,	O
but	O
I	O
am	O
stuck	O
on	O
figuring	O
out	O
the	O
`	O
group_by	O
`	O
or	O
`	O
pivot	O
`	O
(	O
or	O
???	O
)	O
statements	O
to	O
make	O
that	O
work	O
.	O

Oh	O
my	O
.	O

This	O
is	O
actually	O
so	O
simple	O
!	O

@CODE	O

Follow	O
up	O
edit	O
2013-10-29	O

In	O
the	O
case	O
where	O
I	O
have	O
a	O
fairly	O
complex	O
`	O
MultiIndex	O
`	O
,	O
I	O
think	O
I	O
prefer	O
the	O
`	O
groupby	B-API
`	O
approach	O
.	O

Here's	O
simple	O
example	O
for	O
posterity	O
:	O

@CODE	O

and	O
here's	O
the	O
important	O
part	O

@CODE	O

A	O
simple	O
solution	O
is	O
to	O
use	O
`	O
drop_duplicates	B-API
`	O

@CODE	O

For	O
me	O
,	O
this	O
operated	O
quickly	O
on	O
large	O
data	O
sets	O
.	O

This	O
requires	O
that	O
'	O
rownum	O
'	O
be	O
the	O
column	O
with	O
duplicates	O
.	O

In	O
the	O
modified	O
example	O
,	O
'	O
rownum	O
'	O
has	O
no	O
duplicates	O
,	O
therefore	O
nothing	O
gets	O
eliminated	O
.	O

What	O
we	O
really	O
want	O
is	O
to	O
have	O
the	O
'	O
cols	O
'	O
be	O
set	O
to	O
the	O
index	O
.	O

I've	O
not	O
found	O
a	O
way	O
to	O
tell	O
drop_duplicates	B-API
to	O
only	O
consider	O
the	O
index	O
.	O

Here	O
is	O
a	O
solution	O
that	O
adds	O
the	O
index	O
as	O
a	O
dataframe	B-API
column	O
,	O
drops	O
duplicates	O
on	O
that	O
,	O
then	O
removes	O
the	O
new	O
column	O
:	O

@CODE	O

And	O
if	O
you	O
want	O
things	O
back	O
in	O
the	O
proper	O
order	O
,	O
just	O
call	O
`	O
sort	O
`	O
on	O
the	O
dataframe	B-API
.	O

@CODE	O

Unfortunately	O
,	O
I	O
don't	O
think	O
Pandas	O
allows	O
one	O
to	O
drop	O
dups	O
off	O
the	O
indices	O
.	O

I	O
would	O
suggest	O
the	O
following	O
:	O

@CODE	O
